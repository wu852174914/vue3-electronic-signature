(function(m,r){typeof exports=="object"&&typeof module<"u"?r(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],r):(m=typeof globalThis<"u"?globalThis:m||self,r(m.Vue3ElectronicSignature={},m.Vue))})(this,function(m,r){"use strict";var ct=Object.defineProperty;var ut=(m,r,S)=>r in m?ct(m,r,{enumerable:!0,configurable:!0,writable:!0,value:S}):m[r]=S;var w=(m,r,S)=>(ut(m,typeof r!="symbol"?r+"":r,S),S);function S(a,e){return Math.sqrt(Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2))}function z(a,e){return Math.atan2(e.y-a.y,e.x-a.x)}function X(a,e,o,t){const n=e||a,l=o||a,u=.2,h=z(n,l)*(t?1:-1),s=S(n,l)*u;return{x:a.x+Math.cos(h)*s,y:a.y+Math.sin(h)*s,time:a.time}}function Y(a,e,o){if(!o.pressure.enabled)return o.strokeWidth;const t=S(a,e),n=e.time-a.time,l=n>0?t/n:0,u=Math.max(.1,Math.min(1,1-l*.01)),{min:h,max:s}=o.pressure;return h+(s-h)*u}function N(a,e,o){if(e.length<2)return;if(a.strokeStyle=o.strokeColor,a.lineCap="round",a.lineJoin="round",!o.smoothing||e.length<3){a.beginPath(),a.lineWidth=o.strokeWidth,a.moveTo(e[0].x,e[0].y);for(let n=1;n<e.length;n++)a.lineTo(e[n].x,e[n].y);a.stroke();return}a.beginPath(),a.moveTo(e[0].x,e[0].y);for(let n=1;n<e.length-1;n++){const l=e[n],u=e[n+1];o.pressure.enabled?a.lineWidth=Y(e[n-1],l,o):a.lineWidth=o.strokeWidth;const h=X(l,e[n-1],u);a.quadraticCurveTo(h.x,h.y,l.x,l.y)}const t=e[e.length-1];a.lineTo(t.x,t.y),a.stroke()}function A(a){const{canvasSize:e,paths:o}=a;let t=`<svg width="${e.width}" height="${e.height}" xmlns="http://www.w3.org/2000/svg">`;return o.forEach(n=>{if(n.points.length<2)return;let l=`M ${n.points[0].x} ${n.points[0].y}`;for(let u=1;u<n.points.length;u++)l+=` L ${n.points[u].x} ${n.points[u].y}`;t+=`<path d="${l}" stroke="${n.strokeColor}" stroke-width="${n.strokeWidth}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`}),t+="</svg>",t}function O(a,e,o={format:"png"}){const{format:t,quality:n=.9,size:l,backgroundColor:u}=o;if(t==="svg")return A(e);const h=document.createElement("canvas"),s=h.getContext("2d");if(l){h.width=l.width,h.height=l.height;const p=l.width/a.width,g=l.height/a.height;s.scale(p,g)}else h.width=a.width,h.height=a.height;switch(u&&u!=="transparent"&&(s.fillStyle=u,s.fillRect(0,0,h.width,h.height)),s.drawImage(a,0,0),t){case"jpeg":return h.toDataURL("image/jpeg",n);case"base64":return h.toDataURL("image/png").split(",")[1];case"png":default:return h.toDataURL("image/png")}}function q(a,e){return new Promise((o,t)=>{const n=new Image;n.onload=()=>{const l=a.getContext("2d");l.clearRect(0,0,a.width,a.height),l.drawImage(n,0,0,a.width,a.height),o()},n.onerror=t,n.src=e})}function M(a){return a.paths.length===0||a.paths.every(e=>e.points.length===0)}function _(a,e){return{paths:[],canvasSize:{width:a,height:e},timestamp:Date.now(),isEmpty:!0}}function D(a){return JSON.parse(JSON.stringify(a))}class F{constructor(e){w(this,"canvas");w(this,"ctx");w(this,"replayData",null);w(this,"state","idle");w(this,"currentTime",0);w(this,"speed",1);w(this,"animationId",null);w(this,"startTimestamp",0);w(this,"pausedTime",0);w(this,"options",{});w(this,"eventCallbacks",new Map);this.canvas=e,this.ctx=e.getContext("2d")}setReplayData(e,o={}){console.log("设置回放数据:",e),console.log("回放选项:",o),this.replayData=e,this.options={...o},this.speed=o.speed||e.speed||1,this.currentTime=o.startTime||0,this.state="idle",console.log("回放数据设置完成，路径数量:",e.paths.length),console.log("总时长:",e.totalDuration)}play(){if(console.log("播放方法调用，回放数据:",this.replayData),console.log("当前状态:",this.state),!this.replayData){console.error("没有回放数据，无法播放");return}if(this.replayData.totalDuration<=0){console.error("回放数据总时长为0，无法播放");return}if(this.replayData.paths.length===0){console.error("回放数据没有路径，无法播放");return}if(this.state==="playing"){console.log("已在播放中，忽略");return}this.state==="paused"?(console.log("从暂停状态恢复播放"),this.state="playing",this.startTimestamp=performance.now()-this.pausedTime,this.emit("replay-resume")):(console.log("开始新的播放"),this.state="playing",this.startTimestamp=performance.now(),this.pausedTime=0,this.currentTime=this.options.startTime||0,this.clearCanvas(),this.emit("replay-start")),this.animate()}pause(){this.state==="playing"&&(this.state="paused",this.pausedTime=performance.now()-this.startTimestamp,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.emit("replay-pause"))}stop(){this.state="stopped",this.currentTime=0,this.pausedTime=0,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.clearCanvas(),this.emit("replay-stop")}seek(e){if(!this.replayData)return;const o=this.options.endTime||this.replayData.totalDuration;this.currentTime=Math.max(0,Math.min(e,o)),this.state==="playing"?this.startTimestamp=performance.now()-this.currentTime/this.speed:this.pausedTime=this.currentTime/this.speed,this.renderFrame(this.currentTime)}setSpeed(e){const o=this.state==="playing";o&&this.pause(),this.speed=Math.max(.1,Math.min(5,e)),this.emit("replay-speed-change",this.speed),o&&this.play()}getState(){return this.state}getCurrentTime(){return this.currentTime}getTotalDuration(){var e;return((e=this.replayData)==null?void 0:e.totalDuration)||0}getProgress(){const e=this.getTotalDuration();return e>0?this.currentTime/e:0}animate(){if(this.state!=="playing"||!this.replayData)return;const e=performance.now();this.currentTime=(e-this.startTimestamp)*this.speed;const o=this.options.endTime||this.replayData.totalDuration;if(this.currentTime>=o){this.currentTime=o,this.state="completed",this.renderFrame(this.currentTime),this.emit("replay-complete"),this.options.loop&&setTimeout(()=>{this.currentTime=this.options.startTime||0,this.play()},500);return}this.renderFrame(this.currentTime),this.emit("replay-progress",this.getProgress(),this.currentTime),this.animationId=requestAnimationFrame(()=>this.animate())}renderFrame(e){if(!this.replayData)return;this.clearCanvas();let o=!1;for(let t=0;t<this.replayData.paths.length;t++){const n=this.replayData.paths[t],l=n.startTime||0,u=n.endTime||l+(n.duration||0);if(e<l)break;if(e>=u){this.drawCompletePath(n),!o&&Math.abs(e-u)<32&&this.emit("replay-path-end",t,n);continue}o=!0;const h=Math.max(0,Math.min(1,(e-l)/Math.max(u-l,1)));h>0&&Math.abs(e-l)<32&&this.emit("replay-path-start",t,n),this.drawPartialPath(n,h);break}}drawCompletePath(e){if(!(e.points.length<2)){this.ctx.beginPath(),this.ctx.strokeStyle=e.strokeColor,this.ctx.lineWidth=e.strokeWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.moveTo(e.points[0].x,e.points[0].y);for(let o=1;o<e.points.length;o++)this.ctx.lineTo(e.points[o].x,e.points[o].y);this.ctx.stroke()}}drawPartialPath(e,o){if(e.points.length<2)return;const t=e.startTime||0,n=e.duration||0,l=t+n*o,u=this.getPointsUpToTime(e.points,t,l);u.length<2||(this.ctx.beginPath(),this.ctx.strokeStyle=e.strokeColor,this.ctx.lineWidth=e.strokeWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.drawSmoothCurve(u),this.ctx.stroke())}getPointsUpToTime(e,o,t){const n=[];for(let l=0;l<e.length;l++){const u=e[l],h=o+(u.relativeTime||l*50);if(h<=t)n.push(u);else{if(l>0){const s=e[l-1],p=o+(s.relativeTime||(l-1)*50);if(p<=t){const g=(t-p)/(h-p),d={x:s.x+(u.x-s.x)*g,y:s.y+(u.y-s.y)*g,time:t,pressure:s.pressure?s.pressure+(u.pressure||s.pressure-s.pressure)*g:u.pressure};n.push(d)}}break}}return n}drawSmoothCurve(e){if(e.length<2)return;if(this.ctx.moveTo(e[0].x,e[0].y),e.length===2){this.ctx.lineTo(e[1].x,e[1].y);return}for(let n=1;n<e.length-1;n++){const l=e[n],u=e[n+1],h=(l.x+u.x)/2,s=(l.y+u.y)/2;this.ctx.quadraticCurveTo(l.x,l.y,h,s)}const o=e[e.length-1],t=e[e.length-2];this.ctx.quadraticCurveTo(t.x,t.y,o.x,o.y)}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}on(e,o){this.eventCallbacks.has(e)||this.eventCallbacks.set(e,[]),this.eventCallbacks.get(e).push(o)}off(e,o){if(this.eventCallbacks.has(e))if(o){const t=this.eventCallbacks.get(e),n=t.indexOf(o);n>-1&&t.splice(n,1)}else this.eventCallbacks.delete(e)}emit(e,...o){const t=this.eventCallbacks.get(e);t&&t.forEach(n=>n(...o))}destroy(){this.stop(),this.eventCallbacks.clear(),this.replayData=null}}function H(a){const e=a.paths.map(s=>{const p=s.points.map((d,T)=>{var v;let f;if(d.time&&s.points[0].time)f=d.time-s.points[0].time;else if(T===0)f=0;else{const P=s.points[T-1],x=Math.sqrt(Math.pow(d.x-P.x,2)+Math.pow(d.y-P.y,2))/100*1e3;f=(((v=p[T-1])==null?void 0:v.relativeTime)||0)+Math.max(x,16)}return{...d,relativeTime:f}}),g=p.length>0?p[p.length-1].relativeTime:0;return{...s,points:p,duration:g}}),o=[];for(let s=0;s<e.length;s++){const p=e[s];let g;if(s===0)g=0;else{const f=o[s-1],v=xe(a.paths[s-1].points,a.paths[s].points);g=f.endTime+v}const d=g+p.duration,T={...p,startTime:g,endTime:d};console.log(`路径 ${s}: 开始时间=${g}, 结束时间=${d}, 持续时间=${p.duration}`),o.push(T)}const t=o.length>0?o[o.length-1].endTime:0;console.log("回放数据生成完成:"),console.log("- 路径数量:",o.length),console.log("- 总时长:",t),console.log("- 路径详情:",o.map(s=>({startTime:s.startTime,endTime:s.endTime,duration:s.duration,pointCount:s.points.length})));const n=o.reduce((s,p)=>s+Ce(p.points),0),l=t>0?n/(t/1e3):0,u=o.slice(1).map((s,p)=>{const g=o[p];return s.startTime-g.endTime}),h=u.length>0?u.reduce((s,p)=>s+p,0)/u.length:0;return{paths:o,totalDuration:t,speed:1,metadata:{deviceType:ke(a),averageSpeed:l,totalDistance:n,averagePauseTime:h}}}function xe(a,e){if(a.length===0||e.length===0)return 200;const o=a[a.length-1],t=e[0];if(o.time&&t.time)return Math.max(t.time-o.time,50);const n=Math.sqrt(Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2));return Math.min(Math.max(n*2,100),1e3)}function ke(a){const e=a.paths.reduce((l,u)=>l+u.points.length,0),o=a.paths.length;if(e===0)return"touch";const t=e/o;return t>20?"touch":t<10?"mouse":a.paths.some(l=>l.points.some(u=>u.pressure!==void 0))?"pen":"touch"}function Ce(a){let e=0;for(let o=1;o<a.length;o++){const t=a[o].x-a[o-1].x,n=a[o].y-a[o-1].y;e+=Math.sqrt(t*t+n*n)}return e}const be=["width","height"],Se={key:1,class:"signature-toolbar"},De=["disabled"],Pe=["disabled"],Ee=["disabled"],Me={key:2,class:"replay-controls"},_e={class:"replay-buttons"},Re=["disabled"],We={key:0},Ie={key:1},Ne=["disabled"],Ve={class:"replay-progress"},$e=["max","value","disabled"],Be={class:"time-display"},ze={class:"replay-speed"},Xe=r.defineComponent({__name:"ElectronicSignature",props:{showToolbar:{type:Boolean,default:!1},width:{default:"100%"},height:{default:300},strokeColor:{default:"#000000"},strokeWidth:{default:2},backgroundColor:{default:"transparent"},disabled:{type:Boolean,default:!1},placeholder:{default:"请在此处签名"},smoothing:{type:Boolean,default:!0},pressureSensitive:{type:Boolean,default:!1},minStrokeWidth:{default:1},maxStrokeWidth:{default:4},borderStyle:{default:"1px solid #ddd"},borderRadius:{default:"4px"},replayMode:{type:Boolean},replayData:{},replayOptions:{}},emits:["signature-start","signature-drawing","signature-end","signature-clear","signature-undo","signature-redo","replay-start","replay-progress","replay-pause","replay-resume","replay-stop","replay-complete","replay-path-start","replay-path-end","replay-speed-change"],setup(a,{expose:e,emit:o}){const t=a,n=o,l=r.ref(),u=r.ref(!1),h=r.ref(null),s=r.ref(_(0,0)),p=r.ref([]),g=r.ref(-1),d=r.ref(null),T=r.ref(!1),f=r.ref("idle"),v=r.ref(0),P=r.ref(0),C=r.computed(()=>typeof t.width=="number"?t.width:800),x=r.computed(()=>typeof t.height=="number"?t.height:300),Le=r.computed(()=>({position:"relative",display:"inline-block",width:typeof t.width=="string"?t.width:`${t.width}px`,height:typeof t.height=="string"?t.height:`${t.height}px`})),je=r.computed(()=>({border:t.borderStyle,borderRadius:t.borderRadius,backgroundColor:t.backgroundColor,cursor:t.disabled?"not-allowed":"crosshair",display:"block",width:"100%",height:"100%"})),Je=r.computed(()=>({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#999",fontSize:"14px",pointerEvents:"none",userSelect:"none"})),Ge=r.computed(()=>t.placeholder&&M(s.value)),j=r.computed(()=>g.value>0),J=r.computed(()=>g.value<p.value.length-1),G=r.computed(()=>T.value&&d.value),b=r.computed(()=>!G.value&&!t.disabled),Qe=r.computed(()=>{var i;return G.value&&((i=t.replayOptions)==null?void 0:i.showControls)!==!1}),Q=r.computed(()=>({strokeColor:t.strokeColor,strokeWidth:t.strokeWidth,smoothing:t.smoothing,pressure:{enabled:t.pressureSensitive,min:t.minStrokeWidth,max:t.maxStrokeWidth}})),K=()=>{var i;return((i=l.value)==null?void 0:i.getContext("2d"))||null},R=(i,c)=>{const y=l.value,k=y.getBoundingClientRect(),B=y.width/k.width,I=y.height/k.height;return{x:(i-k.left)*B,y:(c-k.top)*I,time:Date.now()}},Z=i=>{if(!b.value)return;u.value=!0;const c=performance.now(),y={...i,time:c};h.value={points:[y],strokeColor:t.strokeColor,strokeWidth:t.strokeWidth,startTime:c,endTime:c,duration:0},n("signature-start")},ee=i=>{if(!u.value||!h.value||!b.value)return;const c=performance.now(),y={...i,time:c};h.value.points.push(y),h.value.startTime&&(h.value.endTime=c,h.value.duration=c-h.value.startTime);const k=K();k&&N(k,h.value.points,Q.value),oe(),n("signature-drawing",s.value)},te=()=>{if(!(!u.value||!h.value)){if(u.value=!1,h.value.points.length>0){const i=h.value.points[h.value.points.length-1];i.time&&h.value.startTime&&(h.value.endTime=i.time,h.value.duration=i.time-h.value.startTime)}s.value.paths.push(h.value),s.value.isEmpty=!1,s.value.timestamp=Date.now(),W(),h.value=null,n("signature-end",s.value)}},Ke=i=>{i.preventDefault();const c=R(i.clientX,i.clientY);Z(c)},Ze=i=>{if(i.preventDefault(),!u.value)return;const c=R(i.clientX,i.clientY);ee(c)},ae=i=>{i.preventDefault(),te()},et=i=>{if(i.preventDefault(),i.touches.length!==1)return;const c=i.touches[0],y=R(c.clientX,c.clientY);Z(y)},tt=i=>{if(i.preventDefault(),i.touches.length!==1||!u.value)return;const c=i.touches[0],y=R(c.clientX,c.clientY);ee(y)},ne=i=>{i.preventDefault(),te()},oe=()=>{s.value.canvasSize={width:C.value,height:x.value},s.value.isEmpty=M(s.value)},W=()=>{p.value=p.value.slice(0,g.value+1),p.value.push(D(s.value)),g.value=p.value.length-1;const i=50;p.value.length>i&&(p.value=p.value.slice(-i),g.value=p.value.length-1)},E=()=>{const i=K();i&&(i.clearRect(0,0,C.value,x.value),t.backgroundColor&&t.backgroundColor!=="transparent"&&(i.fillStyle=t.backgroundColor,i.fillRect(0,0,C.value,x.value)),s.value.paths.forEach(c=>{if(c.points.length>0){const y={strokeColor:c.strokeColor,strokeWidth:c.strokeWidth,smoothing:t.smoothing,pressure:Q.value.pressure};N(i,c.points,y)}}))},ie=()=>{l.value&&(d.value&&d.value.destroy(),d.value=new F(l.value),d.value.on("replay-start",()=>{f.value="playing",n("replay-start")}),d.value.on("replay-progress",(i,c)=>{v.value=i,P.value=c,n("replay-progress",i,c)}),d.value.on("replay-pause",()=>{f.value="paused",n("replay-pause")}),d.value.on("replay-resume",()=>{f.value="playing",n("replay-resume")}),d.value.on("replay-stop",()=>{f.value="stopped",n("replay-stop")}),d.value.on("replay-complete",()=>{f.value="completed",n("replay-complete")}),d.value.on("replay-path-start",(i,c)=>{n("replay-path-start",i,c)}),d.value.on("replay-path-end",(i,c)=>{n("replay-path-end",i,c)}),d.value.on("replay-speed-change",i=>{n("replay-speed-change",i)}))},se=(i,c)=>{d.value||ie(),d.value&&(T.value=!0,d.value.setReplayData(i,c||{}),console.log("startReplay调用，自动播放:",c==null?void 0:c.autoPlay),(c==null?void 0:c.autoPlay)===!0&&d.value.play())},re=i=>{T.value=i,!i&&d.value&&(d.value.stop(),E())},at=()=>M(s.value)?null:H(s.value),le=()=>{var i;(i=d.value)==null||i.play()},ce=()=>{var i;(i=d.value)==null||i.pause()},ue=()=>{var i;(i=d.value)==null||i.stop()},he=i=>{var c;(c=d.value)==null||c.seek(i)},de=i=>{var c;(c=d.value)==null||c.setSpeed(i)},nt=()=>{var i;return((i=d.value)==null?void 0:i.getState())||"idle"},ot=()=>{var i;return((i=d.value)==null?void 0:i.getCurrentTime())||0},$=()=>{var i;return((i=d.value)==null?void 0:i.getTotalDuration())||0},it=()=>{var i;return((i=d.value)==null?void 0:i.getProgress())||0},pe=i=>{const c=Math.floor(i/1e3),y=Math.floor(c/60),k=c%60;return`${y}:${k.toString().padStart(2,"0")}`},me=()=>{b.value&&(s.value=_(C.value,x.value),E(),W(),n("signature-clear"))},ge=()=>{!j.value||!b.value||(g.value--,s.value=D(p.value[g.value]),E(),n("signature-undo",s.value))},fe=()=>{!J.value||!b.value||(g.value++,s.value=D(p.value[g.value]),E(),n("signature-redo",s.value))},ye=i=>{const c=l.value;return O(c,s.value,i)},ve=()=>M(s.value),Te=async i=>{if(!b.value)return;const c=l.value;await q(c,i),s.value=_(C.value,x.value),s.value.isEmpty=!1,W()},st=()=>D(s.value),rt=i=>{b.value&&(s.value=D(i),E(),W())},we=(i,c)=>{const y=i||C.value,k=c||x.value,B=ye({format:"png"});r.nextTick(()=>{const I=l.value;I.width=y,I.height=k,ve()||Te(B),oe()})},lt=()=>{const i=l.value;i.width=C.value,i.height=x.value,s.value=_(C.value,x.value),p.value=[D(s.value)],g.value=0,E()};return r.watch([()=>t.width,()=>t.height],()=>{r.nextTick(()=>{l.value&&we()})}),r.watch(()=>t.replayMode,i=>{i!==void 0&&re(i)}),r.watch(()=>t.replayData,i=>{i&&t.replayMode&&d.value&&(d.value.setReplayData(i,t.replayOptions||{}),console.log("回放数据已更新:",i))}),r.onMounted(()=>{r.nextTick(()=>{lt(),ie(),t.replayMode&&t.replayData&&se(t.replayData,t.replayOptions)})}),r.onUnmounted(()=>{d.value&&(d.value.destroy(),d.value=null)}),e({clear:me,undo:ge,redo:fe,save:ye,isEmpty:ve,fromDataURL:Te,getSignatureData:st,setSignatureData:rt,resize:we,startReplay:se,getReplayData:at,setReplayMode:re,play:le,pause:ce,stop:ue,seek:he,setSpeed:de,getState:nt,getCurrentTime:ot,getTotalDuration:$,getProgress:it}),(i,c)=>(r.openBlock(),r.createElementBlock("div",{class:"electronic-signature",style:r.normalizeStyle(Le.value)},[r.createElementVNode("canvas",{ref_key:"canvasRef",ref:l,width:C.value,height:x.value,style:r.normalizeStyle(je.value),onMousedown:Ke,onMousemove:Ze,onMouseup:ae,onMouseleave:ae,onTouchstart:et,onTouchmove:tt,onTouchend:ne,onTouchcancel:ne},null,44,be),Ge.value?(r.openBlock(),r.createElementBlock("div",{key:0,class:"signature-placeholder",style:r.normalizeStyle(Je.value)},r.toDisplayString(i.placeholder),5)):r.createCommentVNode("",!0),i.showToolbar?(r.openBlock(),r.createElementBlock("div",Se,[r.createElementVNode("button",{onClick:me,disabled:!b.value},"清除",8,De),r.createElementVNode("button",{onClick:ge,disabled:!b.value||!j.value},"撤销",8,Pe),r.createElementVNode("button",{onClick:fe,disabled:!b.value||!J.value},"重做",8,Ee)])):r.createCommentVNode("",!0),Qe.value?(r.openBlock(),r.createElementBlock("div",Me,[r.createElementVNode("div",_e,[r.createElementVNode("button",{onClick:c[0]||(c[0]=y=>f.value==="playing"?ce():le()),disabled:f.value==="idle",class:"replay-btn play-pause-btn"},[f.value==="playing"?(r.openBlock(),r.createElementBlock("span",We,"⏸️")):(r.openBlock(),r.createElementBlock("span",Ie,"▶️"))],8,Re),r.createElementVNode("button",{onClick:c[1]||(c[1]=y=>ue()),disabled:f.value==="idle",class:"replay-btn stop-btn"}," ⏹️ ",8,Ne)]),r.createElementVNode("div",Ve,[r.createElementVNode("input",{type:"range",min:"0",max:$(),value:P.value,onInput:c[2]||(c[2]=y=>he(Number(y.target.value))),class:"progress-slider",disabled:f.value==="idle"},null,40,$e),r.createElementVNode("div",Be,[r.createElementVNode("span",null,r.toDisplayString(pe(P.value)),1),c[4]||(c[4]=r.createElementVNode("span",null,"/",-1)),r.createElementVNode("span",null,r.toDisplayString(pe($())),1)])]),r.createElementVNode("div",ze,[c[6]||(c[6]=r.createElementVNode("label",null,"速度:",-1)),r.createElementVNode("select",{onChange:c[3]||(c[3]=y=>de(Number(y.target.value))),class:"speed-select"},c[5]||(c[5]=[r.createElementVNode("option",{value:"0.5"},"0.5x",-1),r.createElementVNode("option",{value:"1",selected:""},"1x",-1),r.createElementVNode("option",{value:"1.5"},"1.5x",-1),r.createElementVNode("option",{value:"2"},"2x",-1)]),32)])])):r.createCommentVNode("",!0)],4))}}),ht="",V=((a,e)=>{const o=a.__vccOpts||a;for(const[t,n]of e)o[t]=n;return o})(Xe,[["__scopeId","data-v-7184cb09"]]);function U(){return window.devicePixelRatio||1}function Ye(a){const e=a.getContext("2d"),o=U(),t=a.clientWidth,n=a.clientHeight;return a.width=t*o,a.height=n*o,e.scale(o,o),a.style.width=t+"px",a.style.height=n+"px",e}function L(a){if(a.paths.length===0)return{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};let e=1/0,o=1/0,t=-1/0,n=-1/0;return a.paths.forEach(l=>{l.points.forEach(u=>{e=Math.min(e,u.x),o=Math.min(o,u.y),t=Math.max(t,u.x),n=Math.max(n,u.y)})}),{minX:e,minY:o,maxX:t,maxY:n,width:t-e,height:n-o}}function Ae(a,e,o=10){const t=L(e);if(t.width===0||t.height===0){const s=document.createElement("canvas");return s.width=1,s.height=1,s}const n=document.createElement("canvas"),l=n.getContext("2d"),u=t.width+o*2,h=t.height+o*2;return n.width=u,n.height=h,l.drawImage(a,t.minX-o,t.minY-o,u,h,0,0,u,h),n}function Oe(a,e,o,t=!0){const n=document.createElement("canvas"),l=n.getContext("2d");let u=e,h=o;if(t){const s=a.width/a.height,p=e/o;s>p?h=e/s:u=o*s}return n.width=u,n.height=h,l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(a,0,0,u,h),n}function qe(a,e,o={}){const{fontSize:t=12,fontFamily:n="Arial",color:l="#999",opacity:u=.5,position:h="bottom-right"}=o,s=document.createElement("canvas"),p=s.getContext("2d");s.width=a.width,s.height=a.height,p.drawImage(a,0,0),p.font=`${t}px ${n}`,p.fillStyle=l,p.globalAlpha=u;const d=p.measureText(e).width,T=t;let f,v;switch(h){case"top-left":f=10,v=T+10;break;case"top-right":f=a.width-d-10,v=T+10;break;case"bottom-left":f=10,v=a.height-10;break;case"bottom-right":f=a.width-d-10,v=a.height-10;break;case"center":f=(a.width-d)/2,v=(a.height+T)/2;break;default:f=a.width-d-10,v=a.height-10}return p.fillText(e,f,v),p.globalAlpha=1,s}function Fe(a){const e=document.createElement("canvas"),o=e.getContext("2d");e.width=a.width,e.height=a.height,o.drawImage(a,0,0);const t=o.getImageData(0,0,a.width,a.height),n=t.data;for(let l=0;l<n.length;l+=4){const u=n[l]*.299+n[l+1]*.587+n[l+2]*.114;n[l]=u,n[l+1]=u,n[l+2]=u}return o.putImageData(t,0,0),e}const He={install:a=>{a.component("ElectronicSignature",V)},ElectronicSignature:V},Ue="1.0.0";m.ElectronicSignature=V,m.SignatureReplayController=F,m.addWatermark=qe,m.calculateStrokeWidth=Y,m.cloneSignatureData=D,m.convertToGrayscale=Fe,m.createEmptySignatureData=_,m.createReplayData=H,m.cropSignature=Ae,m.default=He,m.drawSmoothPath=N,m.exportSignature=O,m.getAngle=z,m.getControlPoint=X,m.getDevicePixelRatio=U,m.getDistance=S,m.getSignatureBounds=L,m.isSignatureEmpty=M,m.loadImageToCanvas=q,m.resizeSignature=Oe,m.setupHighDPICanvas=Ye,m.signatureToSVG=A,m.version=Ue,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
